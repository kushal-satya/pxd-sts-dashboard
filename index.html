<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>India's Seed Varieties Dashboard</title>
  <link rel="icon" href="PxD_logo.png" type="image/png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-slate-50 min-h-screen">
  <!-- Enhanced Header with PxD Branding -->
  <header class="bg-white shadow-md border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center gap-3">
          <img src="PxD_logo.png" alt="PxD" class="h-12 w-auto" />
          <div>
            <h1 class="text-2xl font-bold text-dark-green">India's Seed Varieties Dashboard</h1>
            <p class="text-gray-600 text-sm">Stress-Tolerant Seed Variety Identification by Precision Development</p>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button id="btn-reload" class="px-4 py-2 rounded bg-primary-green text-white text-sm hover:bg-dark-green transition-colors">Reload Data</button>
          <button id="btn-about" class="px-4 py-2 rounded border border-primary-green text-primary-green text-sm hover:bg-light-accent transition-colors">About</button>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <!-- Statistics Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div class="stat-card">
        <div class="text-2xl font-bold text-gray-900" id="total-varieties">405</div>
        <div class="text-sm text-gray-600">Total Varieties</div>
      </div>
      <div class="stat-card">
        <div class="text-2xl font-bold text-gray-900" id="stress-tolerant">317</div>
        <div class="text-sm text-gray-600">Stress Tolerant</div>
      </div>
      <div class="stat-card">
        <div class="text-2xl font-bold text-gray-900" id="high-evidence">226</div>
        <div class="text-sm text-gray-600">High Evidence Quality</div>
      </div>
      <div class="stat-card">
        <div class="text-2xl font-bold text-gray-900" id="total-crops">130</div>
        <div class="text-sm text-gray-600">Different Crops</div>
      </div>
    </div>

    <!-- Enhanced Filters with Better State Handling -->
    <div class="bg-white rounded-lg shadow-md p-4 hover-lift transition-all mb-4">
      <div class="mb-4">
        <input id="search-box" type="text" placeholder="Search by variety name, crop, or stress attributes..." 
               class="search-box" aria-label="Search varieties" />
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-6 gap-4" role="region" aria-label="Filters">
        <div class="filter-group">
          <label for="crop-filter">Crop Type</label>
          <select id="crop-filter" multiple size="5" aria-label="Crop filter">
            <!-- Populated by JavaScript -->
          </select>
        </div>
        
        <div class="filter-group">
          <label for="state-filter">States</label>
          <select id="state-filter" multiple size="5" aria-label="State filter">
            <!-- Populated by JavaScript -->
          </select>
          <div class="text-xs text-gray-500 mt-1">Multi-state varieties supported</div>
        </div>
        
        <div class="filter-group">
          <label for="stress-filter">Stress Tolerance</label>
          <select id="stress-filter" multiple size="2" aria-label="Stress tolerance filter">
            <option value="Yes">Yes - Stress Tolerant</option>
            <option value="No">No - Standard Variety</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="stress-type-filter">Stress Types</label>
          <input type="text" id="stress-search" placeholder="Search stress types..." class="text-xs border rounded px-2 py-1 mb-1 w-full">
          <select id="stress-type-filter" multiple size="3" aria-label="Specific stress types">
            <!-- Populated by JavaScript -->
          </select>
        </div>
        
        <div class="filter-group">
          <label for="evidence-filter">Evidence Quality</label>
          <select id="evidence-filter" multiple size="3" aria-label="Evidence quality filter">
            <option value="High">High Quality</option>
            <option value="Medium">Medium Quality</option>
            <option value="Low">Low Quality</option>
          </select>
        </div>
        
        <div class="text-sm text-gray-600">
          Click any row to view sources and research evidence
        </div>
      </div>
      
      <div class="flex justify-between items-center mt-4">
        <div class="flex items-center gap-4">
          <div class="relative">
            <label for="column-visibility" class="text-sm font-medium text-gray-700 mr-2">Show/Hide Columns:</label>
            <div class="relative inline-block">
              <button id="columns-dropdown-btn" class="inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-green">
                <span>Columns</span>
                <svg class="ml-2 -mr-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div id="columns-dropdown" class="hidden absolute left-0 mt-1 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10">
                <div class="py-1 text-xs space-y-1 p-2">
                  <label class="flex items-center"><input type="checkbox" data-col="crop" checked class="mr-2"> Crop Type</label>
                  <label class="flex items-center"><input type="checkbox" data-col="variety" checked class="mr-2"> Variety</label>
                  <label class="flex items-center"><input type="checkbox" data-col="year" checked class="mr-2"> Year</label>
                  <label class="flex items-center"><input type="checkbox" data-col="stress" checked class="mr-2"> Stress Tolerance</label>
                  <label class="flex items-center"><input type="checkbox" data-col="attributes" checked class="mr-2"> Attributes</label>
                  <label class="flex items-center"><input type="checkbox" data-col="states" checked class="mr-2"> States</label>
                  <label class="flex items-center"><input type="checkbox" data-col="seasons" class="mr-2"> Seasons</label>
                  <label class="flex items-center"><input type="checkbox" data-col="maturity" class="mr-2"> Days to Maturity</label>
                  <label class="flex items-center"><input type="checkbox" data-col="evidence" checked class="mr-2"> Evidence Quality</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <button id="btn-export-csv" class="px-4 py-2 bg-primary-green text-white rounded-md text-sm hover:bg-dark-green transition-colors" aria-label="Export CSV">
          Export Enhanced Data
        </button>
      </div>
    </div>

    <!-- Enhanced Table with Dual-View Indicators -->
    <div class="main-table">
      <div class="table-responsive">
        <table id="varieties-table" aria-label="Enhanced varieties table">
          <thead>
            <tr>
              <th data-key="crop" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Crop Type
              </th>
              <th data-key="variety" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Variety Name
              </th>
              <th data-key="year" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Year of Release
              </th>
              <th data-key="stress" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Stress Tolerance
              </th>
              <th data-key="attributes" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Key Attributes
              </th>
              <th data-key="states" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                States
              </th>
              <th data-key="seasons" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Seasons
              </th>
              <th data-key="maturity" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Days to Maturity
              </th>
              <th data-key="evidence" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Evidence Quality
              </th>
            </tr>
          </thead>
          <tbody id="varieties-tbody">
            <!-- Populated by JavaScript -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Enhanced Pagination -->
    <div class="flex items-center justify-between mt-4" aria-label="Pagination controls">
      <div class="flex items-center gap-4">
        <div class="text-sm text-gray-600">
          Show:
          <select id="page-size" class="ml-1 border rounded px-2 py-1" aria-label="Page size">
            <option>25</option>
            <option>50</option>
            <option>100</option>
            <option>200</option>
          </select>
          per page
        </div>
      </div>
      <div class="flex items-center gap-2">
        <button id="page-prev" class="px-3 py-2 border rounded text-sm hover:bg-gray-50 disabled:opacity-50 transition-colors" aria-label="Previous page">
          ← Previous
        </button>
        <span id="page-info" class="text-sm text-gray-700 px-3">Page 1</span>
        <button id="page-next" class="px-3 py-2 border rounded text-sm hover:bg-gray-50 disabled:opacity-50 transition-colors" aria-label="Next page">
          Next →
        </button>
      </div>
    </div>
  </main>

  <!-- Footer with Data Source Indicators -->
  <footer class="bg-white border-t border-gray-200 mt-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div class="flex justify-center items-center gap-6 text-sm text-gray-600">
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 bg-green-500 rounded-full"></div>
          <span>Seednet Available</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
          <span>AI-Research Enhanced</span>
        </div>
        <div class="text-xs text-gray-500">
          Powered by Google Gemini 2.5 Flash
        </div>
      </div>
    </div>
  </footer>

  <!-- Enhanced Dual-View Modal -->
  <div id="variety-modal" class="modal" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
    <div class="modal-content" role="document">
      <span class="close" aria-label="Close modal">&times;</span>
      <div id="modal-body">
        <!-- Populated by JavaScript with dual-view content -->
      </div>
    </div>
  </div>

  <!-- Load Enhanced JavaScript -->
  <script src="script_enhanced.js"></script>
</body>
</html>
