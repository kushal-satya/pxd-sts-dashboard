<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PxD Enhanced Stress-Tolerant Seed Varieties Dashboard</title>
  <link rel="icon" href="PxD_logo.png" type="image/png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-slate-50 min-h-screen">
  <!-- Enhanced Header with PxD Branding -->
  <header class="bg-white shadow-md border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center gap-3">
          <img src="PxD_logo.png" alt="PxD" class="h-12 w-auto" />
          <div>
            <h1 class="text-2xl font-bold text-dark-green">PxD Enhanced Stress-Tolerant Seed Varieties Dashboard</h1>
            <p class="text-gray-600 text-sm">Official Seednet Portal + AI-Enhanced Research • Dual-Source Intelligence</p>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <div class="hidden md:flex items-center gap-4 text-sm text-gray-600 mr-4">
            <div class="flex items-center gap-1">
              <div class="w-3 h-3 bg-green-500 rounded-full"></div>
              <span>Seednet Available</span>
            </div>
            <div class="flex items-center gap-1">
              <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
              <span>AI Enhanced</span>
            </div>
          </div>
          <button id="btn-reload" class="px-3 py-1.5 rounded bg-primary-green text-white text-sm hover:bg-dark-green transition-colors">Reload Data</button>
          <button id="btn-about" class="px-3 py-1.5 rounded border border-primary-green text-primary-green text-sm hover:bg-light-accent transition-colors">About</button>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <!-- Enhanced Statistics Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div class="stat-card">
        <div class="stat-number" id="total-varieties">0</div>
        <div class="stat-label">Total Varieties</div>
        <div class="text-xs text-gray-500 mt-1">Official + Research Data</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="stress-tolerant">0</div>
        <div class="stat-label">Stress Tolerant</div>
        <div class="text-xs text-gray-500 mt-1">AI-Verified Evidence</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="high-evidence">0</div>
        <div class="stat-label">High Evidence Quality</div>
        <div class="text-xs text-gray-500 mt-1">Research Validation</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="total-crops">0</div>
        <div class="stat-label">Different Crops</div>
        <div class="text-xs text-gray-500 mt-1">Crop Diversity</div>
      </div>
    </div>

    <!-- Enhanced Filters with Better State Handling -->
    <div class="bg-white rounded-lg shadow-md p-4 hover-lift transition-all mb-4">
      <div class="mb-4">
        <input id="search-box" type="text" placeholder="Search by variety name, crop, or stress attributes..." 
               class="search-box" aria-label="Search varieties" />
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-6 gap-4" role="region" aria-label="Filters">
        <div class="filter-group">
          <label for="crop-filter">Crop Type</label>
          <select id="crop-filter" multiple size="5" aria-label="Crop filter">
            <!-- Populated by JavaScript -->
          </select>
        </div>
        
        <div class="filter-group">
          <label for="state-filter">States</label>
          <select id="state-filter" multiple size="5" aria-label="State filter">
            <!-- Populated by JavaScript -->
          </select>
          <div class="text-xs text-gray-500 mt-1">Multi-state varieties supported</div>
        </div>
        
        <div class="filter-group">
          <label for="stress-filter">Stress Tolerance</label>
          <select id="stress-filter" multiple size="2" aria-label="Stress tolerance filter">
            <option value="Yes">Yes - Stress Tolerant</option>
            <option value="No">No - Standard Variety</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="evidence-filter">Evidence Quality</label>
          <select id="evidence-filter" multiple size="3" aria-label="Evidence quality filter">
            <option value="High">High Quality</option>
            <option value="Medium">Medium Quality</option>
            <option value="Low">Low Quality</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="stress-type-filter">Type of Stress</label>
          <select id="stress-type-filter" multiple size="5" aria-label="Type of stress filter">
            <!-- Populated dynamically by JavaScript -->
          </select>
          <div class="text-xs text-gray-500 mt-1">AI-detected stress types</div>
        </div>
        
        <div class="filter-group">
          <label for="seednet-filter">Data Source</label>
          <select id="seednet-filter" multiple size="3" aria-label="Data source filter">
            <option value="seednet">Seednet Portal</option>
            <option value="research">Research Only</option>
            <option value="both">Both Sources</option>
          </select>
        </div>
      </div>
      
      <div class="mt-4 flex items-center justify-between">
        <button id="btn-reset" class="px-4 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-800 border transition-colors" aria-label="Reset filters">
          Reset All Filters
        </button>
        <div class="text-sm text-gray-700" aria-live="polite">
          <span id="filtered-count">0</span> of <span id="total-count">0</span> varieties • 
          Last updated: <span id="last-updated">—</span>
        </div>
      </div>
    </div>

    <!-- Enhanced Table Controls -->
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-4">
        <div class="relative">
          <button id="btn-columns" class="px-3 py-2 border rounded text-sm hover:bg-gray-50 transition-colors" aria-haspopup="true" aria-expanded="false">
            Configure Columns ▾
          </button>
          <div id="columns-menu" class="absolute left-0 mt-1 bg-white border rounded shadow-lg p-3 hidden text-sm z-20 min-w-48" role="menu" aria-label="Toggle columns">
            <label class="block mb-2"><input type="checkbox" data-col="crop" checked> Crop Type</label>
            <label class="block mb-2"><input type="checkbox" data-col="variety" checked> Variety Name</label>
            <label class="block mb-2"><input type="checkbox" data-col="year" checked> Year of Release</label>
            <label class="block mb-2"><input type="checkbox" data-col="stress" checked> Stress Tolerance</label>
            <label class="block mb-2"><input type="checkbox" data-col="attributes" checked> Key Attributes</label>
            <label class="block mb-2"><input type="checkbox" data-col="states" checked> States</label>
            <label class="block mb-2"><input type="checkbox" data-col="seasons" checked> Seasons</label>
            <label class="block mb-2"><input type="checkbox" data-col="maturity" checked> Days to Maturity</label>
            <label class="block"><input type="checkbox" data-col="evidence" checked> Evidence Quality</label>
          </div>
        </div>
        
        <div class="text-sm text-gray-600">
          Click any row to view dual-source details
        </div>
      </div>
      
      <button id="btn-export-csv" class="px-3 py-2 border rounded text-sm hover:bg-gray-50 transition-colors" aria-label="Export CSV">
        Export Enhanced Data
      </button>
    </div>

    <!-- Enhanced Table with Dual-View Indicators -->
    <div class="main-table">
      <div class="table-responsive">
        <table id="varieties-table" aria-label="Enhanced varieties table">
          <thead>
            <tr>
              <th data-key="crop" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Crop Type
              </th>
              <th data-key="variety" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Variety Name
              </th>
              <th data-key="year" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Year of Release
              </th>
              <th data-key="stress" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Stress Tolerance
              </th>
              <th data-key="attributes" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Key Attributes
              </th>
              <th data-key="states" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                States
              </th>
              <th data-key="seasons" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Seasons
              </th>
              <th data-key="maturity" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Days to Maturity
              </th>
              <th data-key="evidence" class="sortable" tabindex="0" role="columnheader" aria-sort="none">
                Evidence Quality
              </th>
            </tr>
          </thead>
          <tbody id="varieties-tbody">
            <!-- Populated by JavaScript -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Enhanced Pagination -->
    <div class="flex items-center justify-between mt-4" aria-label="Pagination controls">
      <div class="flex items-center gap-4">
        <div class="text-sm text-gray-600">
          Show:
          <select id="page-size" class="ml-1 border rounded px-2 py-1" aria-label="Page size">
            <option>25</option>
            <option>50</option>
            <option>100</option>
            <option>200</option>
          </select>
          per page
        </div>
      </div>
      <div class="flex items-center gap-2">
        <button id="page-prev" class="px-3 py-2 border rounded text-sm hover:bg-gray-50 disabled:opacity-50 transition-colors" aria-label="Previous page">
          ← Previous
        </button>
        <span id="page-info" class="text-sm text-gray-700 px-3">Page 1</span>
        <button id="page-next" class="px-3 py-2 border rounded text-sm hover:bg-gray-50 disabled:opacity-50 transition-colors" aria-label="Next page">
          Next →
        </button>
      </div>
    </div>
  </main>

  <!-- Enhanced Dual-View Modal -->
  <div id="variety-modal" class="modal" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
    <div class="modal-content" role="document">
      <span class="close" aria-label="Close modal">&times;</span>
      <div id="modal-body">
        <!-- Populated by JavaScript with dual-view content -->
      </div>
    </div>
  </div>

  <!-- Load Enhanced JavaScript -->
  <script src="script_enhanced.js"></script>
</body>
</html>
